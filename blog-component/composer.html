<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link href="https://cdn.quilljs.com/1.0.0/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    
    <div class="container">
        <h1>News and Events</h1>

        <nav class="nav nav-tabs">
            <a class="nav-link" href="/">Blog / Events</a>
            <a class="nav-link" href="/newsFeed">News</a>
            <a class="nav-link active" href="/composer">Blog Composer</a>
        </nav>

        <h2 class="text-center">Post a new blog</h2>
        <div class="alertcontainer"></div>
        <form action="/" method="POST">
            <!-- Create the editor container -->
            <div id="editor">
                <test type='text' name='content'>Hello World!</test>
            </div>
            <input class='btn btn-success' type="submit" value="Post blog">
        </form>
    </div>
    <!-- Include the Quill library -->
    <script src="https://cdn.quilljs.com/1.0.0/quill.js"></script>
    <!-- Initialize Quill editor -->
    <script>
    var toolbarOptions = [
        ['bold', 'italic', 'underline', 'strike'], // toggled buttons
        ['blockquote', 'code-block'],
        [{ 'list': 'ordered' }, { 'list': 'bullet' }],
        [{ 'indent': '-1' }, { 'indent': '+1' }], // outdent/indent

        [{ 'size': ['small', false, 'large', 'huge'] }], // custom dropdown
        [{ 'header': [1, 2, 3, 4, 5, 6, false] }],

        [{ 'color': [] }, { 'background': [] }], // dropdown with defaults from theme
        [{ 'font': [] }],
        [{ 'align': [] }],
        ['clean'],
        ['link','image'] // remove formatting button
    ];

    var quill = new Quill('#editor', {
        modules: {
            toolbar: toolbarOptions
        },
        theme: 'snow'
    });

    $('form').on('submit', (event) => {
        event.preventDefault();
        $.ajax({
            url: '/',
            type: 'POST',
            data: {content: $('.ql-editor').html()},
        })
        .done(function(data) {
            console.log("success");
            console.log(data);
            window.location.href = '/';
        })
        .fail(function(err) {
            console.log(err);
            $('.alertcontainer').html($('<div>').addClass('alert alert-danger').text(err.statusText));
            $('body').scrollTop(0);


        })
        .always(function() {
            console.log("complete");
        });
        
    });
    </script>
</body>

</html>